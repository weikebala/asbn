<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>{if $title}{$title}{else}{if !empty($_W['account']['name'])}{$_W['account']['name']}{/if}{/if}</title>
<meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<meta charset="utf-8">
<link type="text/css" rel="stylesheet" href="./resource/style/bootstrap.css">
<link type="text/css" rel="stylesheet" href="./resource/style/font-awesome.min.css" />

<link href="./themes/xingwei08/css/idangerous.swiper.css" rel="stylesheet" type="text/css" >
<link href="./themes/xingwei08/css/cate.css" rel="stylesheet" type="text/css"/>
<link href="./themes/xingwei08/css/iscroll.css" rel="stylesheet" type="text/css"/>

<script src="./themes/xingwei08/js/iscroll.js" type="text/javascript"></script>

<script type="text/javascript">
var myScroll;

function loaded() {
myScroll = new iScroll('wrapper', {
snap: true,
momentum: false,
hScrollbar: false,
onScrollEnd: function () {
document.querySelector('#indicator > li.active').className = '';
document.querySelector('#indicator > li:nth-child(' + (this.currPageX+1) + ')').className = 'active';
}
 });
 
 
}

document.addEventListener('DOMContentLoaded', loaded, false);
</script>
 
</head>

<body id="cate18">
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js" type="text/javascript"></script> 
<script>
var playbox = (function(){
	//author:eric_wu
	var _playbox = function(){
		var that = this;
		that.box = null;
		that.player = null;
		that.src = null;
		that.on = false;
		//
		that.autoPlayFix = {
			on: true,
			//evtName: ("ontouchstart" in window)?"touchend":"click"
			evtName: ("ontouchstart" in window)?"touchstart":"mouseover"
			
		}

	}
	_playbox.prototype = {
		init: function(box_ele){
			this.box = "string" === typeof(box_ele)?document.getElementById(box_ele):box_ele;
			this.player = this.box.querySelectorAll("audio")[0];
			this.src = this.player.src;
			this.init = function(){return this;}
			this.autoPlayEvt(true);
			return this;
		},
		play: function(){
			if(this.autoPlayFix.on){
				this.autoPlayFix.on = false;
				this.autoPlayEvt(false);
			}
			this.on = !this.on;
			if(true == this.on){
				this.player.src = this.src;
				this.player.play();
			}else{
				this.player.pause();
				this.player.src = null;
			}
			if("function" == typeof(this.play_fn)){
				this.play_fn.call(this);
			}
		},
		handleEvent: function(evt){
			this.play();
		},
		autoPlayEvt: function(important){
			if(important || this.autoPlayFix.on){
				document.body.addEventListener(this.autoPlayFix.evtName, this, false);
			}else{
				document.body.removeEventListener(this.autoPlayFix.evtName, this, false);
			}
		}
	}
	//
	return new _playbox();
})();

playbox.play_fn = function(){
	this.box.className = this.on?"btn_music on":"btn_music";
}
</script> 

<!--背景音乐start--> 
<script src="./themes/xingwei08/js/audio.js" type="text/javascript"></script> 
<script type="text/javascript">
			var myScroll;

			function loaded() {
				myScroll = new iScroll('wrapper', {
					snap: true,
					momentum: false,
					hScrollbar: false,
					onScrollEnd: function() {
						document.querySelector('#indicator > li.active').className = '';
						document.querySelector('#indicator > li:nth-child(' + (this.currPageX + 1) + ')').className = 'active';
					}
				});

			}

			document.addEventListener('DOMContentLoaded', loaded, false);
		</script> 
<!--music-->
<style>
.btn_music {display:inline-block; width:35px; height:35px; background:url('./themes/xingwei08/images/play.png') no-repeat center center; background-size: 100% auto; position:absolute;z-index: 100; left:15px; top:20px;}
.btn_music.on {background-image: url("./themes/xingwei08/images/stop.png");}

</style>
 
<span id="playbox" class="btn_music" onclick="playbox.init(this).play();">
   <audio id="audio" loop src="{$_W['styles']['xw_music']}" autoplay preload ></audio>
</span>

<div id="insert1" style="z-index:10000; position:fixed; top:20px;"></div>
  <div class="banner">
       <div id="wrapper">
            <div id="scroller">
                  <ul id="thelist">
                      {data module="" func="site_slide_search" return="" item="row" limit="4"}
                      <li style="background-image:url('{$row['thumb']}');background-attachment: inherit;background-repeat:no-repeat;background-size:cover;-moz-background-size:cover;-webkit-background-size:cover; background-position: center center "> {/data}
                  </ul>
            </div>
       </div>
       <div class="clr"> </div>
 </div>



<div class="device">
     <a class="arrow-left" href="#"></a> 
     <a class="arrow-right" href="#"></a>
     <div class="swiper-container">
          <div class="swiper-wrapper">
               <div class="swiper-slide">
                    <div class="content-slide">
                         {loop $navs $i=>$nav}
                         <a href="{$nav['url']}" >
                            {if !empty($nav['icon'])}
                            <p class="ico" style="width:70%; height:60px; margin:0 auto; padding:0; display:block;">
                            <img src="{$_W['attachurl']}{$nav['icon']}" width="100%" height="100%" style="margin:0; border-radius:5px;" />
                            </p>
                            {else}
                            <p class="ico"  style="width:70%; height:45px; margin:0 auto; padding-top:15px; display:block; background:rgba(234, 234, 234, 0.59); border-radius:5px;">
                            <i class="fa {$nav['css']['icon']['icon']} icon" style="{$nav['css']['icon']['style']}"></i>
                            </p>
                            {/if}
                            <p class="title">{$nav['name']}</p>
                         </a>
                            {if $i%9 == 8}
                    </div>
               </div>
               <div class="swiper-slide">
                    <div class="content-slide">
                     {/if}
                     {/loop}
                    </div>
               </div>
          </div>
          <div class="pagination"></div>
          
     </div>
     <div style="width:100%; height:30px; margin-top:3px; color:#333; text-align:center; line-height:30px; font-size:14px;">
     Copyright &copy; {$_W['account']['name']}
     </div>


<script src="./themes/xingwei08/js/jquery-1.10.1.min.js" type="text/javascript"></script>
<script src="./themes/xingwei08/js/idangerous.swiper-2.1.min.js" type="text/javascript"></script>
  <script>
  var mySwiper = new Swiper('.swiper-container',{
    pagination: '.pagination',
    loop:true,
    grabCursor: true,
    paginationClickable: true
  })
  $('.arrow-left').on('click', function(e){
    e.preventDefault()
    mySwiper.swipePrev()
  })
  $('.arrow-right').on('click', function(e){
    e.preventDefault()
    mySwiper.swipeNext()
  })
</script>

<script>
var count = document.getElementById("thelist").getElementsByTagName("img").length;  

var count2 = document.getElementsByClassName("menuimg").length;
for(i=0;i<count;i++){
 document.getElementById("thelist").getElementsByTagName("img").item(i).style.cssText = " width:"+document.body.clientWidth+"px";

}
document.getElementById("scroller").style.cssText = " width:"+document.body.clientWidth*count+"px";

 setInterval(function(){
myScroll.scrollToPage('next', 0,400,count);
},3500 );
window.onresize = function(){ 
for(i=0;i<count;i++){
document.getElementById("thelist").getElementsByTagName("img").item(i).style.cssText = " width:"+document.body.clientWidth+"px";

}
 document.getElementById("scroller").style.cssText = " width:"+document.body.clientWidth*count+"px";
} 
</script>


</div>

 
 <script>
var count = document.getElementById("thelist").getElementsByTagName("li").length;	

var count2 = document.getElementsByClassName("menuimg").length;
for(i=0;i<count;i++){
 document.getElementById("thelist").getElementsByTagName("li").item(i).style.width = document.documentElement.clientWidth+"px";
  document.getElementById("thelist").getElementsByTagName("li").item(i).style.height = document.documentElement.clientHeight+"px";
  //document.getElementById("thelist").getElementsByTagName("img").item(i).style.width = document.documentElement.clientWidth+"px";
  //document.getElementById("thelist").getElementsByTagName("img").item(i).style.height = document.documentElement.clientHeight+"px";
}
document.getElementById("scroller").style.cssText = " width:"+document.documentElement.clientWidth*count+"px";

   setInterval(function(){
myScroll.scrollToPage('next', 0,400,count);
},3500 );
window.onresize = function(){ 
for(i=0;i<count;i++){
document.getElementById("thelist").getElementsByTagName("li").item(i).style.width = document.documentElement.clientWidth+"px";
  document.getElementById("thelist").getElementsByTagName("li").item(i).style.height = document.documentElement.clientHeight+"px";
  //document.getElementById("thelist").getElementsByTagName("img").item(i).style.width = document.documentElement.clientWidth+"px";
  //document.getElementById("thelist").getElementsByTagName("img").item(i).style.height = document.documentElement.clientHeight+"px";
}
 document.getElementById("scroller").style.cssText = " width:"+document.documentElement.clientWidth*count+"px";
} 
</script>

<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js" type="text/javascript"></script>
 
<script>
function displayit(n){
	for(i=0;i<4;i++){
		if(i==n){
			var id='menu_list'+n;
			if(document.getElementById(id).style.display=='none'){
				document.getElementById(id).style.display='';
				document.getElementById("plug-wrap").style.display='';
			}else{
				document.getElementById(id).style.display='none';
				document.getElementById("plug-wrap").style.display='none';
			}
		}else{
			if($('#menu_list'+i)){
				$('#menu_list'+i).css('display','none');
			}
		}
	}
}
function closeall(){
	var count = document.getElementById("top_menu").getElementsByTagName("ul").length;
	for(i=0;i<count;i++){
		document.getElementById("top_menu").getElementsByTagName("ul").item(i).style.display='none';
	}
	document.getElementById("plug-wrap").style.display='none';
}

document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
	WeixinJSBridge.call('hideToolbar');
});
</script>

<?php
	$_share['title'] = !empty($_share['title']) ? $_share['title'] : $_W['account']['name'];
	$_share['imgUrl'] = !empty($_share['imgUrl']) ? $_share['imgUrl'] : '';
	if(isset($_share['content'])){
		$_share['desc'] = $_share['content'];
		unset($_share['content']);
	}
	$_share['desc'] = !empty($_share['desc']) ? $_share['desc'] : '';
	$_share['desc'] = preg_replace('/\s/i', '', str_replace('	', '', cutstr(str_replace('&nbsp;', '', ihtmlspecialchars(strip_tags($_share['desc']))), 60)));
	if(empty($_share['link'])) {
		$_share['link'] = '';
		$query_string = $_SERVER['QUERY_STRING'];
		if(!empty($query_string)) {
			//加上分享人的uid
			parse_str($query_string, $query_arr);
			$query_arr['u'] = $_W['member']['uid'];
			$query_string = http_build_query($query_arr);
			$_share['link'] = $_W['siteroot'].'app/index.php?'. $query_string;
		}
	}
?>

<script type="text/javascript">
	
	wx.config(jssdkconfig);
	
	var $_share = {php echo json_encode($_share);};
	
	if(typeof sharedata == 'undefined'){
		sharedata = $_share;
	} else {
		sharedata['title'] = sharedata['title'] || $_share['title'];
		sharedata['desc'] = sharedata['desc'] || $_share['desc'];
		sharedata['link'] = sharedata['link'] || $_share['link'];
		sharedata['imgUrl'] = sharedata['imgUrl'] || $_share['imgUrl'];
	}

	function tomedia(src) {
		if(typeof src != 'string')
			return '';
		if(src.indexOf('http://') == 0 || src.indexOf('https://') == 0) {
			return src;
		} else if(src.indexOf('../addons') == 0 || src.indexOf('../attachment') == 0) {
			src=src.substr(3);
			return window.sysinfo.siteroot + src;
		} else if(src.indexOf('./resource') == 0) {
			src=src.substr(2);
			return window.sysinfo.siteroot + 'app/' + src;
		} else if(src.indexOf('images/') == 0) {
			return window.sysinfo.attachurl+ src;
		}
	}
	
	if(sharedata.imgUrl == ''){
		var _share_img = $('body img:eq(0)').attr("src");
		if(_share_img == ""){
			sharedata['imgUrl'] = window.sysinfo.attachurl + 'images/global/wechat_share.png';
		} else {
			sharedata['imgUrl'] = tomedia(_share_img);
		}
	}
	
	if(sharedata.desc == ''){
		var _share_content = _removeHTMLTag($('body').html());
		if(typeof _share_content == 'string'){
			sharedata.desc = _share_content.replace($_share['title'], '')
		}
	}
	
	wx.ready(function () {
		wx.onMenuShareAppMessage(sharedata);
		wx.onMenuShareTimeline(sharedata);
		wx.onMenuShareQQ(sharedata);
		wx.onMenuShareWeibo(sharedata);
	});
	{if $controller == 'site' && $action == 'site'}
		$('#category_show').click(function(){
			$('.head .order').toggleClass('hide');
			return false;
		});
		//文章点击和分享加积分
		{if !empty($_GPC['u'])}
			var url = "{php echo url('site/site/handsel/', array('id' => $detail['id'], 'action' => 'click', 'u' => $_GPC['u']), true);}";
			$.post(url, function(dat){});
		{/if}
		sharedata.success = function(){
			var url = "{php echo url('site/site/handsel/', array('id' => $detail['id'], 'action' => 'share'));}";
			$.post(url, function(dat){});
		}
	{/if}
</script> 

<script>
		require(['jquery'],function(){
			$(function(){
				if($('.quick')!=null && $('.quick')!=''){
					var h = $('.quick').height()+'px';
					$('body').css("padding-bottom",h);
				}else{
					$('body').css("padding-bottom", "0");
				}
			})
		});
</script>

{if !empty($_W['quickmenu']['menus']) && empty($_W['quickmenu']['disabled'])}
<link href="{$_W['siteroot']}app/resource/css/font-awesome.min.css" rel="stylesheet">
<style>
.quick.quick-quick {position:fixed; bottom:0; left:0; z-index:100; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); -moz-tap-highlight-color: rgba(0, 0, 0, 0);}
.quick.quick-quick .quick-menu{background-color:#B70000; -webkit-appearance:none;outline:none;display:inline-block; width:16px !important; height:16px !important; padding:12px; border-radius:32px; text-align:center !important; position:absolute; bottom:5px; left:5px; z-index:999; -webkit-transition: -webkit-transform 200ms; -webkit-transform:rotate(1deg);-moz-transition: -webkit-transform 200ms; -moz-transform:rotate(1deg); color:#FFF; box-shadow:0 0 0 2px #FFFFFF;}
.quick.quick-quick .quick-menu:before{font-size:20px;}
.quick.quick-quick .quick-menu:checked{-webkit-transform:rotate(135deg);-moz-transform:rotate(135deg);}
.quick.quick-quick>div {width:20px; height:20px; border-radius:32px; background:#B70000; position:absolute; bottom:5px; left:5px;  z-index:900; -webkit-transition: -webkit-transform 200ms;-moz-transition: -webkit-transform 200ms; padding:10px; box-shadow:0 0 0 1px #FFF;}
.quick.quick-quick>div a{color:#fff; font-size:20px; display: block; height:100%; line-height:33px; text-decoration:none; text-align: center;}
.quick.quick-quick>div a i{ display:inline-block; width:20px; height:20px;}
.quick.quick-quick>div.on:nth-of-type(1) {-webkit-transform: translate(0, -100px) rotate(720deg);-moz-transform: translate(0, -100px) rotate(720deg);}
.quick.quick-quick>div.on:nth-of-type(2) {-webkit-transform: translate(47px, -81px) rotate(720deg);-moz-transform: translate(47px, -81px) rotate(720deg);}
.quick.quick-quick>div.on:nth-of-type(3) {-webkit-transform: translate(81px, -45px) rotate(720deg);-moz-transform: translate(81px, -45px) rotate(720deg);}
.quick.quick-quick>div.on:nth-of-type(4) {-webkit-transform: translate(100px, 0) rotate(720deg);-moz-transform: translate(100px, 0) rotate(720deg);}
</style>

<div class="quick quick-quick" id="quick-quick">
	 <span class="quick-menu img-circle">
          <i class="fa fa-plus"></i>
     </span>
	 <input type="checkbox" id="quick-btn" class="quick-menu img-circle" style="opacity:0;" />
	{php $i = 1;}
	{loop $_W['quickmenu']['menus'] $nav}
	<div {$nav['css']['icon']['style']}">
		 <a href="{$nav['url']}" title="{$nav['name']}">
			{if !empty($nav['icon'])}
			<i style="background:url({$_W['attachurl']}{$nav['icon']}) no-repeat; background-size:cover; width:100%; height:100%;{$nav['css']['icon']['style']}"></i>
			{else}
			<i class="fa fa-fw {$nav['css']['icon']['icon']}" style="{$nav['css']['icon']['style']}"></i>
			{/if}
		</a>
	</div>
	{php if($i>4) break;}
	{php $i++;}
	{/loop}
</div>
<script>
window.addEventListener("DOMContentLoaded", function(){
	var btn = document.getElementById("quick-btn");
	btn.onclick = function(){
		var divs = document.getElementById("quick-quick").querySelectorAll("div");
		var className = className=this.checked?"on":"";
		for(var i = 0;i<divs.length; i++){
			divs[i].className = className;
		}
	}
}, false);
</script>
{/if}


</body>
</html>
